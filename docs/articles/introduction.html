<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to precrec • precrec</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">precrec</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/introduction.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/takayasaito/precrec">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to precrec</h1>
            
            <h4 class="date">2017-08-23</h4>
          </div>

    
    
<div class="contents">
<p>The <code>precrec</code> package provides accurate computations of ROC and Precision-Recall curves.</p>
<div id="basic-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-functions" class="anchor"></a>1. Basic functions</h2>
<p>The <code>evalmod</code> function calculates ROC and Precision-Recall curves and returns an S3 object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(precrec)

<span class="co"># Load a test dataset</span>
<span class="kw">data</span>(P10N10)

<span class="co"># Calculate ROC and Precision-Recall curves</span>
sscurves &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(<span class="dt">scores =</span> P10N10<span class="op">$</span>scores, <span class="dt">labels =</span> P10N10<span class="op">$</span>labels)</code></pre></div>
<div id="s3-generics" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-generics" class="anchor"></a>S3 generics</h3>
<p>The R language specifies S3 objects and S3 generic functions as part of the most basic object-oriented system in R. The <code>precrec</code> package provides eight S3 generics for the S3 object created by the <code>evalmod</code> function.</p>
<table class="table">
<thead><tr class="header">
<th align="left">S3 generic</th>
<th align="left">Package</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">print</td>
<td align="left">base</td>
<td align="left">Print the calculation results and the summary of the test data</td>
</tr>
<tr class="even">
<td align="left">as.data.frame</td>
<td align="left">base</td>
<td align="left">Convert a precrec object to a data frame</td>
</tr>
<tr class="odd">
<td align="left">plot</td>
<td align="left">graphics</td>
<td align="left">Plot performance evaluation measures</td>
</tr>
<tr class="even">
<td align="left">autoplot</td>
<td align="left">ggplot2</td>
<td align="left">Plot performance evaluation measures with ggplot2</td>
</tr>
<tr class="odd">
<td align="left">fortify</td>
<td align="left">ggplot2</td>
<td align="left">Prepare a data frame for ggplot2</td>
</tr>
<tr class="even">
<td align="left">auc</td>
<td align="left">precrec</td>
<td align="left">Make a data frame with AUC scores</td>
</tr>
<tr class="odd">
<td align="left">part</td>
<td align="left">precrec</td>
<td align="left">Set partial curves and calculate AUC scores</td>
</tr>
<tr class="even">
<td align="left">pauc</td>
<td align="left">precrec</td>
<td align="left">Make a data frame with pAUC scores</td>
</tr>
</tbody>
</table>
<div id="example-of-the-plot-function" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-plot-function" class="anchor"></a>Example of the plot function</h4>
<p>The <code>plot</code> function outputs ROC and Precision-Recall curves</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show ROC and Precision-Recall plots</span>
<span class="kw"><a href="../reference/plot.html">plot</a></span>(sscurves)

<span class="co"># Show a Precision-Recall plot</span>
<span class="kw"><a href="../reference/plot.html">plot</a></span>(sscurves, <span class="st">"PRC"</span>)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-2-1.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
</div>
<div id="example-of-the-autoplot-function" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-autoplot-function" class="anchor"></a>Example of the autoplot function</h4>
<p>The <code>autoplot</code> function outputs ROC and Precision-Recall curves by using the <code>ggplot2</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The ggplot2 package is required </span>
<span class="kw">library</span>(ggplot2)

<span class="co"># Show ROC and Precision-Recall plots</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(sscurves)

<span class="co"># Show a Precision-Recall plot</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(sscurves, <span class="st">"PRC"</span>)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-3-1.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-3-2.png" width="672"></p>
<p>Reduced supporting points make the plotting speed faster for large data sets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 5 data sets with 50000 positives and 50000 negatives</span>
samp1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_sim_samples.html">create_sim_samples</a></span>(<span class="dv">5</span>, <span class="dv">50000</span>, <span class="dv">50000</span>)

<span class="co"># Calculate curves</span>
eval1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(<span class="dt">scores =</span> samp1<span class="op">$</span>scores, <span class="dt">labels =</span> samp1<span class="op">$</span>labels)

<span class="co"># Reduced supporting points</span>
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(eval1))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Full supporting points</span>
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(eval1, <span class="dt">reduce_points =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   1.284   0.083   1.405 
##    user  system elapsed 
##  15.609   1.824  17.539</code></pre>
</div>
<div id="example-of-the-auc-function" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-auc-function" class="anchor"></a>Example of the auc function</h4>
<p>The <code>auc</code> function outputs a data frame with the AUC (Area Under the Curve) scores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get a data frame with AUC scores</span>
aucs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/auc.html">auc</a></span>(sscurves)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(aucs)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">modnames</th>
<th align="right">dsids</th>
<th align="left">curvetypes</th>
<th align="right">aucs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">m1</td>
<td align="right">1</td>
<td align="left">ROC</td>
<td align="right">0.7200000</td>
</tr>
<tr class="even">
<td align="left">m1</td>
<td align="right">1</td>
<td align="left">PRC</td>
<td align="right">0.7397716</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get AUCs of Precision-Recall</span>
aucs_prc &lt;-<span class="st"> </span><span class="kw">subset</span>(aucs, curvetypes <span class="op">==</span><span class="st"> "PRC"</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(aucs_prc)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">modnames</th>
<th align="right">dsids</th>
<th align="left">curvetypes</th>
<th align="right">aucs</th>
</tr></thead>
<tbody><tr class="odd">
<td>2</td>
<td align="left">m1</td>
<td align="right">1</td>
<td align="left">PRC</td>
<td align="right">0.7397716</td>
</tr></tbody>
</table>
</div>
<div id="example-of-the-as-data-frame-function" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-as-data-frame-function" class="anchor"></a>Example of the as.data.frame function</h4>
<p>The <code>as.data.frame</code> function converts a precrec object to a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert sscurves to a data frame</span>
sscurves.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.data.frame.html">as.data.frame</a></span>(sscurves)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(sscurves.df))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="left">modname</th>
<th align="left">dsid</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.0</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.1</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.2</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.001</td>
<td align="right">0.2</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.002</td>
<td align="right">0.2</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.003</td>
<td align="right">0.2</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="data-preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>2. Data preparation</h2>
<p>The <code>precrec</code> package provides four functions for data preparation.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">join_scores</td>
<td align="left">Join scores of multiple models into a list</td>
</tr>
<tr class="even">
<td align="left">join_labels</td>
<td align="left">Join observed labels of multiple test datasets into a list</td>
</tr>
<tr class="odd">
<td align="left">mmdata</td>
<td align="left">Reformat input data for performance evaluation calculation</td>
</tr>
<tr class="even">
<td align="left">create_sim_samples</td>
<td align="left">Create random samples for simulations</td>
</tr>
</tbody>
</table>
<div id="example-of-the-join_scores-function" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-the-join_scores-function" class="anchor"></a>Example of the join_scores function</h3>
<p>The <code>join_scores</code> function combines multiple score datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)
s2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)
s3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">2</span>)

<span class="co"># Join two score vectors</span>
scores1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/join_scores.html">join_scores</a></span>(s1, s2)

<span class="co"># Join two vectors and a matrix</span>
scores2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/join_scores.html">join_scores</a></span>(s1, s2, s3)</code></pre></div>
</div>
<div id="example-of-the-join_labels-function" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-the-join_labels-function" class="anchor"></a>Example of the join_labels function</h3>
<p>The <code>join_labels</code> function combines multiple score datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)
l2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)
l3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)

<span class="co"># Join two label vectors</span>
labels1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/join_labels.html">join_labels</a></span>(l1, l2)
labels2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/join_labels.html">join_labels</a></span>(l1, l3)</code></pre></div>
</div>
<div id="example-of-the-mmdata-function" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-the-mmdata-function" class="anchor"></a>Example of the mmdata function</h3>
<p>The <code>mmdata</code> function makes an input dataset for the <code>evalmod</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create an input dataset with two score vectors and one label vector</span>
msmdat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(scores1, labels1)

<span class="co"># Specify dataset IDs</span>
smmdat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(scores1, labels2, <span class="dt">dsids =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))

<span class="co"># Specify model names and dataset IDs</span>
mmmdat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(scores1, labels2, <span class="dt">modnames =</span> <span class="kw">c</span>(<span class="st">"mod1"</span>, <span class="st">"mod2"</span>), <span class="dt">dsids =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</code></pre></div>
</div>
<div id="example-of-the-create_sim_samples-function" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-the-create_sim_samples-function" class="anchor"></a>Example of the create_sim_samples function</h3>
<p>The <code>create_sim_samples</code> function is useful to make a random sample dataset with different performance levels.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Level name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">random</td>
<td align="left">Random</td>
</tr>
<tr class="even">
<td align="left">poor_er</td>
<td align="left">Poor early retrieval</td>
</tr>
<tr class="odd">
<td align="left">good_er</td>
<td align="left">Good early retrieval</td>
</tr>
<tr class="even">
<td align="left">excel</td>
<td align="left">Excellent</td>
</tr>
<tr class="odd">
<td align="left">perf</td>
<td align="left">Perfect</td>
</tr>
<tr class="even">
<td align="left">all</td>
<td align="left">All of the above</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A dataset with 10 positives and 10 negatives for the random performance level</span>
samps1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_sim_samples.html">create_sim_samples</a></span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="st">"random"</span>)

<span class="co">#  A dataset for five different performance levels</span>
samps2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_sim_samples.html">create_sim_samples</a></span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="st">"all"</span>)

<span class="co"># A dataset with 20 samples for the good early retrieval performance level</span>
samps3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_sim_samples.html">create_sim_samples</a></span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="st">"good_er"</span>)

<span class="co"># A dataset with 20 samples for five different performance levels</span>
samps4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_sim_samples.html">create_sim_samples</a></span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="st">"all"</span>)</code></pre></div>
</div>
</div>
<div id="multiple-models" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-models" class="anchor"></a>3. Multiple models</h2>
<p>The <code>evalmod</code> function calculate performance evaluation for multiple models when multiple model names are specified with the <code>mmdata</code> or the <code>evalmod</code> function.</p>
<div id="data-preparation-1" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation-1" class="anchor"></a>Data preparation</h3>
<p>There are several ways to create a dataset with the <code>mmdata</code> function for multiple models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use a list with multiple score vectors and a list with a single label vector</span>
msmdat1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(scores1, labels1)

<span class="co"># Explicitly specify model names</span>
msmdat2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(scores1, labels1, <span class="dt">modnames =</span> <span class="kw">c</span>(<span class="st">"mod1"</span>, <span class="st">"mod2"</span>))

<span class="co"># Use a sample dataset created by the create_sim_samples function</span>
msmdat3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(samps2[[<span class="st">"scores"</span>]], samps2[[<span class="st">"labels"</span>]], <span class="dt">modnames =</span> samps2[[<span class="st">"modnames"</span>]])</code></pre></div>
</div>
<div id="roc-and-precision-recall-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#roc-and-precision-recall-calculations" class="anchor"></a>ROC and Precision-Recall calculations</h3>
<p>The <code>evalmod</code> function automatically detects multiple models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate ROC and Precision-Recall curves for multiple models</span>
mscurves &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(msmdat3)</code></pre></div>
</div>
<div id="s3-generics-1" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-generics-1" class="anchor"></a>S3 generics</h3>
<p>All the S3 generics are effective for the S3 object generated by this approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show ROC and Precision-Recall curves with the ggplot2 package</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(mscurves)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div id="example-of-the-as-data-frame-function-1" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-as-data-frame-function-1" class="anchor"></a>Example of the as.data.frame function</h4>
<p>The <code>as.data.frame</code> function also works with this object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert mscurves to a data frame</span>
mscurves.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.data.frame.html">as.data.frame</a></span>(mscurves)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(mscurves.df))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="left">modname</th>
<th align="left">dsid</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0</td>
<td align="left">random</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.001</td>
<td align="right">0</td>
<td align="left">random</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.002</td>
<td align="right">0</td>
<td align="left">random</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.003</td>
<td align="right">0</td>
<td align="left">random</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.004</td>
<td align="right">0</td>
<td align="left">random</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.005</td>
<td align="right">0</td>
<td align="left">random</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="multiple-test-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-test-sets" class="anchor"></a>4. Multiple test sets</h2>
<p>The <code>evalmod</code> function calculate performance evaluation for multiple test datasets when different test dataset IDs are specified with the <code>mmdata</code> or the <code>evalmod</code> function.</p>
<div id="data-preparation-2" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation-2" class="anchor"></a>Data preparation</h3>
<p>There are several ways to create a dataset with the <code>mmdata</code> function for multiple test datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Specify test dataset IDs names</span>
smmdat1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(scores1, labels2, <span class="dt">dsids =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))

<span class="co"># Use a sample dataset created by the create_sim_samples function</span>
smmdat2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(samps3[[<span class="st">"scores"</span>]], samps3[[<span class="st">"labels"</span>]], <span class="dt">dsids =</span> samps3[[<span class="st">"dsids"</span>]])</code></pre></div>
</div>
<div id="roc-and-precision-recall-calculations-1" class="section level3">
<h3 class="hasAnchor">
<a href="#roc-and-precision-recall-calculations-1" class="anchor"></a>ROC and Precision-Recall calculations</h3>
<p>The <code>evalmod</code> function automatically detects multiple test datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate curves for multiple test datasets and keep all the curves</span>
smcurves &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(smmdat2, <span class="dt">raw_curves =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="s3-generics-2" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-generics-2" class="anchor"></a>S3 generics</h3>
<p>All the S3 generics are effective for the S3 object generated by this approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show an average Precision-Recall curve with the 95% confidence bounds</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(smcurves, <span class="st">"PRC"</span>, <span class="dt">show_cb =</span> <span class="ot">TRUE</span>)

<span class="co"># Show raw Precision-Recall curves</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(smcurves, <span class="st">"PRC"</span>, <span class="dt">show_cb =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-17-1.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-17-2.png" width="672"></p>
<div id="example-of-the-as-data-frame-function-2" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-as-data-frame-function-2" class="anchor"></a>Example of the as.data.frame function</h4>
<p>The <code>as.data.frame</code> function also works with this object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert smcurves to a data frame</span>
smcurves.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.data.frame.html">as.data.frame</a></span>(smcurves)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(smcurves.df))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="left">modname</th>
<th align="left">dsid</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.0</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.1</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.2</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.3</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.4</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.001</td>
<td align="right">0.4</td>
<td align="left">m1</td>
<td align="left">1</td>
<td align="left">ROC</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="multiple-models-and-multiple-test-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-models-and-multiple-test-sets" class="anchor"></a>5. Multiple models and multiple test sets</h2>
<p>The <code>evalmod</code> function calculates performance evaluation for multiple models and multiple test datasets when different model names and test dataset IDs are specified with the <code>mmdata</code> or the <code>evalmod</code> function.</p>
<div id="data-preparation-3" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation-3" class="anchor"></a>Data preparation</h3>
<p>There are several ways to create a dataset with the <code>mmdata</code> function for multiple models and multiple datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Specify model names and test dataset IDs names</span>
mmmdat1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(scores1, labels2, <span class="dt">modnames=</span> <span class="kw">c</span>(<span class="st">"mod1"</span>, <span class="st">"mod2"</span>), <span class="dt">dsids =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))

<span class="co"># Use a sample dataset created by the create_sim_samples function</span>
mmmdat2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(samps4[[<span class="st">"scores"</span>]], samps4[[<span class="st">"labels"</span>]], 
                  <span class="dt">modnames =</span> samps4[[<span class="st">"modnames"</span>]], <span class="dt">dsids =</span> samps4[[<span class="st">"dsids"</span>]])</code></pre></div>
</div>
<div id="roc-and-precision-recall-calculations-2" class="section level3">
<h3 class="hasAnchor">
<a href="#roc-and-precision-recall-calculations-2" class="anchor"></a>ROC and Precision-Recall calculations</h3>
<p>The <code>evalmod</code> function automatically detects multiple models and multiple test datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate curves for multiple models and multiple test datasets</span>
mmcurves &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(mmmdat2)</code></pre></div>
</div>
<div id="s3-generics-3" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-generics-3" class="anchor"></a>S3 generics</h3>
<p>All the S3 generics are effective for the S3 object generated by this approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show average Precision-Recall curves</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(mmcurves, <span class="st">"PRC"</span>)

<span class="co"># Show average Precision-Recall curves with the 95% confidence bounds</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(mmcurves, <span class="st">"PRC"</span>, <span class="dt">show_cb =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-21-1.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-21-2.png" width="672"></p>
<div id="example-of-the-as-data-frame-function-3" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-as-data-frame-function-3" class="anchor"></a>Example of the as.data.frame function</h4>
<p>The <code>as.data.frame</code> function also works with this object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert smcurves to a data frame</span>
mmcurves.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.data.frame.html">as.data.frame</a></span>(mmcurves)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(mmcurves.df))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="right">ymin</th>
<th align="right">ymax</th>
<th align="left">modname</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.00</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="left">random</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.09</td>
<td align="right">0.0351136</td>
<td align="right">0.1448864</td>
<td align="left">random</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.001</td>
<td align="right">0.09</td>
<td align="right">0.0351136</td>
<td align="right">0.1448864</td>
<td align="left">random</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.002</td>
<td align="right">0.09</td>
<td align="right">0.0351136</td>
<td align="right">0.1448864</td>
<td align="left">random</td>
<td align="left">ROC</td>
</tr>
<tr class="odd">
<td align="right">0.003</td>
<td align="right">0.09</td>
<td align="right">0.0351136</td>
<td align="right">0.1448864</td>
<td align="left">random</td>
<td align="left">ROC</td>
</tr>
<tr class="even">
<td align="right">0.004</td>
<td align="right">0.09</td>
<td align="right">0.0351136</td>
<td align="right">0.1448864</td>
<td align="left">random</td>
<td align="left">ROC</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="confidence-interval-bands" class="section level2">
<h2 class="hasAnchor">
<a href="#confidence-interval-bands" class="anchor"></a>6. Confidence interval bands</h2>
<p>The <code>evalmod</code> function automatically calculates confidence bands when a model contains multiple test sets in provided dataset. Confidence intervals are calculated for additional supporting points, which are specified by the ‘x_bins’ option of the <code>evalmod</code> function.</p>
<div id="example-of-confidence-bands-when-x_bins-is-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-confidence-bands-when-x_bins-is-2" class="anchor"></a>Example of confidence bands when x_bins is 2</h3>
<p>The dataset <code>smmdat2</code> contains 20 samples for a single model/classifier.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show all curves</span>
smcurves_all &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(smmdat2, <span class="dt">raw_curves =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(smcurves_all)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<p>Additional supporting points are calculated for <code>x = (0, 0.5, 1.0)</code> when <code>x_bins</code> is set to 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x_bins: 2</span>
smcurves_xb2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(smmdat2, <span class="dt">x_bins =</span> <span class="dv">2</span>)
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(smcurves_xb2)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
</div>
<div id="example-of-confidence-bands-when-x_bins-is-10" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-confidence-bands-when-x_bins-is-10" class="anchor"></a>Example of confidence bands when x_bins is 10</h3>
<p>Additional supporting points are calculated for <code>x = (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0)</code> when <code>x_bins</code> is set to 10.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x_bins: 10</span>
smcurves_xb10 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(smmdat2, <span class="dt">x_bins =</span> <span class="dv">10</span>)
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(smcurves_xb10)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
</div>
<div id="example-of-the-alpha-value" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-the-alpha-value" class="anchor"></a>Example of the alpha value</h3>
<p>The <code>evalmod</code> function accepts the <code>cb_alpha</code> option to specify the alpha value of the point-wise confidence bounds calculation. For instance, 95% confidence bands are calculated when <code>cb_alpha</code> is 0.05.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cb_alpha: 0.1 for 90% confidence band</span>
smcurves_cb1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(smmdat2, <span class="dt">x_bins =</span> <span class="dv">10</span>, <span class="dt">cb_alpha =</span> <span class="fl">0.1</span>)
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(smcurves_cb1)

<span class="co"># cb_alpha: 0.01 for 99% confidence band</span>
smcurves_cb2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(smmdat2, <span class="dt">x_bins =</span> <span class="dv">10</span>, <span class="dt">cb_alpha =</span> <span class="fl">0.01</span>)
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(smcurves_cb2)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-26-1.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-26-2.png" width="672"></p>
</div>
</div>
<div id="cross-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-validation" class="anchor"></a>7. Cross validation</h2>
<p>The <code>format_nfold</code> function takes a data frame with scores, label and n-fold columns and convert it to a list for <code>evalmod</code> and <code>mmdata</code>.</p>
<div id="example-of-a-data-frame-with-5-fold-data" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-a-data-frame-with-5-fold-data" class="anchor"></a>Example of a data frame with 5-fold data</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load data</span>
<span class="kw">data</span>(M2N50F5)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(M2N50F5))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">score1</th>
<th align="right">score2</th>
<th align="left">label</th>
<th align="right">fold</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2.0606025</td>
<td align="right">1.0689227</td>
<td align="left">pos</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.3066092</td>
<td align="right">0.1745491</td>
<td align="left">pos</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">1.5597733</td>
<td align="right">-1.5666375</td>
<td align="left">pos</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">-0.6044989</td>
<td align="right">1.1572727</td>
<td align="left">pos</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">-0.2229031</td>
<td align="right">0.6070042</td>
<td align="left">pos</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">-0.7679551</td>
<td align="right">-1.7908147</td>
<td align="left">pos</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
</div>
<div id="example-of-the-format_nfold-function-with-5-fold-datasets" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-format_nfold-function-with-5-fold-datasets" class="anchor"></a>Example of the format_nfold function with 5-fold datasets</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert data frame to list</span>
nfold_list1 =<span class="st"> </span><span class="kw"><a href="../reference/format_nfold.html">format_nfold</a></span>(<span class="dt">nfold_df =</span> M2N50F5,  <span class="dt">score_cols =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), 
                           <span class="dt">lab_col =</span> <span class="dv">3</span>, <span class="dt">fold_col =</span> <span class="dv">4</span>)

<span class="co"># Use column names</span>
nfold_list2 =<span class="st"> </span><span class="kw"><a href="../reference/format_nfold.html">format_nfold</a></span>(<span class="dt">nfold_df =</span> M2N50F5, <span class="dt">score_cols =</span> <span class="kw">c</span>(<span class="st">"score1"</span>, <span class="st">"score2"</span>),
                           <span class="dt">lab_col =</span> <span class="st">"label"</span>, <span class="dt">fold_col =</span> <span class="st">"fold"</span>)

<span class="co"># Use the result for evalmod</span>
cvcurves &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(<span class="dt">scores =</span> nfold_list2<span class="op">$</span>scores, <span class="dt">labels =</span> nfold_list2<span class="op">$</span>labels,
                    <span class="dt">modnames =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">"m1"</span>, <span class="st">"m2"</span>), <span class="dt">each =</span> <span class="dv">5</span>), <span class="dt">dsids =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">2</span>))
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(cvcurves)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
</div>
<div id="evalmod-and-mmdata-with-cross-validation-datasets" class="section level3">
<h3 class="hasAnchor">
<a href="#evalmod-and-mmdata-with-cross-validation-datasets" class="anchor"></a>evalmod and mmdata with cross validation datasets</h3>
<p>Both <code>evalmod</code> and <code>mmdata</code> function can directly take the arguments of the <code>format_nfold</code> function.</p>
<div id="example-of-evalmod-and-mmdata-with-5-fold-data" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-evalmod-and-mmdata-with-5-fold-data" class="anchor"></a>Example of evalmod and mmdata with 5-fold data</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mmdata</span>
cvcurves2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(<span class="dt">nfold_df =</span> M2N50F5, <span class="dt">score_cols =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">lab_col =</span> <span class="dv">3</span>, <span class="dt">fold_col =</span> <span class="dv">4</span>, 
                    <span class="dt">modnames =</span> <span class="kw">c</span>(<span class="st">"m1"</span>, <span class="st">"m2"</span>), <span class="dt">dsids =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)

<span class="co"># evalmod</span>
cvcurves3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(<span class="dt">nfold_df =</span> M2N50F5, <span class="dt">score_cols =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">lab_col =</span> <span class="dv">3</span>, <span class="dt">fold_col =</span> <span class="dv">4</span>, 
                     <span class="dt">modnames =</span> <span class="kw">c</span>(<span class="st">"m1"</span>, <span class="st">"m2"</span>), <span class="dt">dsids =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(cvcurves3)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
</div>
</div>
</div>
<div id="basic-performance-measures" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-performance-measures" class="anchor"></a>8. Basic performance measures</h2>
<p>The <code>evalmod</code> function also calculates basic evaluation measures - error, accuracy, specificity, sensitivity, and precision.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Measure</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">error</td>
<td align="left">Error rate</td>
</tr>
<tr class="even">
<td align="left">accuracy</td>
<td align="left">Accuracy</td>
</tr>
<tr class="odd">
<td align="left">specificity</td>
<td align="left">Specificity, TNR, 1 - FPR</td>
</tr>
<tr class="even">
<td align="left">sensitivity</td>
<td align="left">Sensitivity, TPR, Recall</td>
</tr>
<tr class="odd">
<td align="left">precision</td>
<td align="left">Precision, PPV</td>
</tr>
<tr class="even">
<td align="left">mcc</td>
<td align="left">Matthews correlation coefficient</td>
</tr>
<tr class="odd">
<td align="left">fscore</td>
<td align="left">F-score</td>
</tr>
</tbody>
</table>
<div id="basic-measure-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-measure-calculations" class="anchor"></a>Basic measure calculations</h3>
<p>The <code>mode = "basic"</code> option makes the <code>evalmod</code> function calculate the basic evaluation measures instead of performing ROC and Precision-Recall calculations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate basic evaluation measures</span>
mmpoins &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(mmmdat2, <span class="dt">mode =</span> <span class="st">"basic"</span>)</code></pre></div>
</div>
<div id="s3-generics-4" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-generics-4" class="anchor"></a>S3 generics</h3>
<p>All the S3 generics except for <code>auc</code>, <code>part</code> and <code>pauc</code> are effective for the S3 object generated by this approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show normalized ranks vs. error rate and accuracy</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(mmpoins, <span class="kw">c</span>(<span class="st">"error"</span>, <span class="st">"accuracy"</span>))

<span class="co"># Show normalized ranks vs. specificity, sensitivity, and precision</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(mmpoins, <span class="kw">c</span>(<span class="st">"specificity"</span>, <span class="st">"sensitivity"</span>, <span class="st">"precision"</span>))

<span class="co"># Show normalized ranks vs. Matthews correlation coefficient and F-score</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(mmpoins, <span class="kw">c</span>(<span class="st">"mcc"</span>, <span class="st">"fscore"</span>))</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-31-1.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-31-2.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-31-3.png" width="672"></p>
<div id="normalized-ranks-and-predicted-scores" class="section level4">
<h4 class="hasAnchor">
<a href="#normalized-ranks-and-predicted-scores" class="anchor"></a>Normalized ranks and predicted scores</h4>
<p>In addition to the basic measures, the <code>autoplot</code> function can plot normalized ranks vs. scores and labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show normalized ranks vs. scores and labels</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(mmpoins, <span class="kw">c</span>(<span class="st">"score"</span>, <span class="st">"label"</span>))</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
</div>
<div id="example-of-the-as-data-frame-function-4" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-the-as-data-frame-function-4" class="anchor"></a>Example of the as.data.frame function</h4>
<p>The <code>as.data.frame</code> function also works for the precrec objects of the basic measures.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert mmpoins to a data frame</span>
mmpoins.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.data.frame.html">as.data.frame</a></span>(mmpoins)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(mmpoins.df))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="right">ymin</th>
<th align="right">ymax</th>
<th align="left">modname</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">random</td>
<td align="left">score</td>
</tr>
<tr class="even">
<td align="right">0.05</td>
<td align="right">1.8500557</td>
<td align="right">1.5834688</td>
<td align="right">2.1166426</td>
<td align="left">random</td>
<td align="left">score</td>
</tr>
<tr class="odd">
<td align="right">0.10</td>
<td align="right">1.2961332</td>
<td align="right">1.1404621</td>
<td align="right">1.4518044</td>
<td align="left">random</td>
<td align="left">score</td>
</tr>
<tr class="even">
<td align="right">0.15</td>
<td align="right">1.1004887</td>
<td align="right">0.9611204</td>
<td align="right">1.2398571</td>
<td align="left">random</td>
<td align="left">score</td>
</tr>
<tr class="odd">
<td align="right">0.20</td>
<td align="right">0.8996701</td>
<td align="right">0.7794553</td>
<td align="right">1.0198848</td>
<td align="left">random</td>
<td align="left">score</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
<td align="right">0.7705027</td>
<td align="right">0.6483899</td>
<td align="right">0.8926155</td>
<td align="left">random</td>
<td align="left">score</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="partial-aucs" class="section level2">
<h2 class="hasAnchor">
<a href="#partial-aucs" class="anchor"></a>9. Partial AUCs</h2>
<p>The <code>part</code> function calculates partial AUCs and standardized partial AUCs of both ROC and precision-recall curves. Standardized pAUCs (spAUCs) are standardized to the score range between 0 and 1.</p>
<div id="partial-auc-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#partial-auc-calculations" class="anchor"></a>partial AUC calculations</h3>
<p>It requires an S3 object produced by the <code>evalmod</code> function and uses <code>xlim</code> and <code>ylim</code> to specify the partial area of your choice. The <code>pauc</code> function outputs a data frame with the pAUC scores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate ROC and Precision-Recall curves</span>
curves &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(<span class="dt">scores =</span> P10N10<span class="op">$</span>scores, <span class="dt">labels =</span> P10N10<span class="op">$</span>labels)

<span class="co"># Calculate partial AUCs</span>
curves.part &lt;-<span class="st"> </span><span class="kw"><a href="../reference/part.html">part</a></span>(curves, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.25</span>))

<span class="co"># Retrieve a dataframe of pAUCs</span>
paucs.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pauc.html">pauc</a></span>(curves.part)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(paucs.df)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">modnames</th>
<th align="right">dsids</th>
<th align="left">curvetypes</th>
<th align="right">paucs</th>
<th align="right">spaucs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">m1</td>
<td align="right">1</td>
<td align="left">ROC</td>
<td align="right">0.1006250</td>
<td align="right">0.4025000</td>
</tr>
<tr class="even">
<td align="left">m1</td>
<td align="right">1</td>
<td align="left">PRC</td>
<td align="right">0.2345849</td>
<td align="right">0.9383396</td>
</tr>
</tbody>
</table>
</div>
<div id="s3-generics-5" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-generics-5" class="anchor"></a>S3 generics</h3>
<p>All the S3 generics are effective for the S3 object generated by this approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show ROC and Precision-Recall curves</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(curves.part)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-35-1.png" width="672"></p>
</div>
</div>
<div id="fast-auc-roc-calculation" class="section level2">
<h2 class="hasAnchor">
<a href="#fast-auc-roc-calculation" class="anchor"></a>10. Fast AUC (ROC) calculation</h2>
<p>The area under the ROC curve can be calculated from the U statistic, which is the test statistic of the Mann–Whitney U test.</p>
<div id="auc-calculation-with-the-u-statistic" class="section level3">
<h3 class="hasAnchor">
<a href="#auc-calculation-with-the-u-statistic" class="anchor"></a>AUC calculation with the U statistic</h3>
<p>The <code>evalmod</code> function calculates AUCs with the U statistic when mode = ‘aucroc’.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate AUC (ROC)</span>
aucs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(<span class="dt">scores =</span> P10N10<span class="op">$</span>scores, <span class="dt">labels =</span> P10N10<span class="op">$</span>labels, <span class="dt">mode =</span> <span class="st">'aucroc'</span>)

<span class="co"># Convert to data.frame</span>
aucs.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.data.frame.html">as.data.frame</a></span>(aucs)

<span class="co"># Use knitr::kable to display the result in a table format</span>
knitr<span class="op">::</span><span class="kw">kable</span>(aucs.df)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">modnames</th>
<th align="left">dsids</th>
<th align="right">aucs</th>
<th align="right">ustats</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">m1</td>
<td align="left">1</td>
<td align="right">0.72</td>
<td align="right">72</td>
</tr></tbody>
</table>
</div>
</div>
<div id="balanced-and-imbalanced-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#balanced-and-imbalanced-datasets" class="anchor"></a>11. Balanced and imbalanced datasets</h2>
<p>It is easy to simulate various scenarios, such as balanced vs. imbalanced datasets, by using the <code>evalmod</code> and <code>create_sim_samples</code> functions.</p>
<div id="data-preparation-4" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation-4" class="anchor"></a>Data preparation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Balanced dataset</span>
samps5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_sim_samples.html">create_sim_samples</a></span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="st">"all"</span>)
simmdat1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(samps5[[<span class="st">"scores"</span>]], samps5[[<span class="st">"labels"</span>]], 
                   <span class="dt">modnames =</span> samps5[[<span class="st">"modnames"</span>]], <span class="dt">dsids =</span> samps5[[<span class="st">"dsids"</span>]])

<span class="co"># Imbalanced dataset</span>
samps6 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_sim_samples.html">create_sim_samples</a></span>(<span class="dv">100</span>, <span class="dv">25</span>, <span class="dv">100</span>, <span class="st">"all"</span>)
simmdat2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mmdata.html">mmdata</a></span>(samps6[[<span class="st">"scores"</span>]], samps6[[<span class="st">"labels"</span>]], 
                   <span class="dt">modnames =</span> samps6[[<span class="st">"modnames"</span>]], <span class="dt">dsids =</span> samps6[[<span class="st">"dsids"</span>]])</code></pre></div>
</div>
<div id="roc-and-precision-recall-calculations-3" class="section level3">
<h3 class="hasAnchor">
<a href="#roc-and-precision-recall-calculations-3" class="anchor"></a>ROC and Precision-Recall calculations</h3>
<p>The <code>evalmod</code> function automatically detects multiple models and multiple test datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Balanced dataset</span>
simcurves1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(simmdat1)

<span class="co"># Imbalanced dataset</span>
simcurves2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/evalmod.html">evalmod</a></span>(simmdat2)</code></pre></div>
</div>
<div id="balanced-vs-imbalanced-datasets" class="section level3">
<h3 class="hasAnchor">
<a href="#balanced-vs-imbalanced-datasets" class="anchor"></a>Balanced vs. imbalanced datasets</h3>
<p>ROC plots are unchanged between balanced and imbalanced datasets, whereas Precision-Recall plots show a clear difference between them. See our <a href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0118432">article</a> or <a href="https://classeval.wordpress.com">website</a> for potential pitfalls by using ROC plots with imbalanced datasets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Balanced dataset</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(simcurves1)

<span class="co"># Imbalanced dataset</span>
<span class="kw"><a href="../reference/autoplot.html">autoplot</a></span>(simcurves2)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-39-1.png" width="672"><img src="introduction_files/figure-html/unnamed-chunk-39-2.png" width="672"></p>
</div>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>12. Citation</h2>
<p><em>Precrec: fast and accurate precision-recall and ROC curve calculations in R</em></p>
<p>Takaya Saito; Marc Rehmsmeier</p>
<p>Bioinformatics 2017; 33 (1): 145-147.</p>
<p>doi: <a href="https://doi.org/10.1093/bioinformatics/btw570">10.1093/bioinformatics/btw570</a></p>
</div>
<div id="external-links" class="section level2">
<h2 class="hasAnchor">
<a href="#external-links" class="anchor"></a>13. External links</h2>
<ul>
<li><p><a href="https://classeval.wordpress.com/">Classifier evaluation with imbalanced datasets</a> - our web site that contains several pages with useful tips for performance evaluation on binary classifiers.</p></li>
<li><p><a href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0118432">The Precision-Recall Plot Is More Informative than the ROC Plot When Evaluating Binary Classifiers on Imbalanced Datasets</a> - our paper that summarized potential pitfalls of ROC plots with imbalanced datasets and advantages of using precision-recall plots instead.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-functions">1. Basic functions</a></li>
      <li><a href="#data-preparation">2. Data preparation</a></li>
      <li><a href="#multiple-models">3. Multiple models</a></li>
      <li><a href="#multiple-test-sets">4. Multiple test sets</a></li>
      <li><a href="#multiple-models-and-multiple-test-sets">5. Multiple models and multiple test sets</a></li>
      <li><a href="#confidence-interval-bands">6. Confidence interval bands</a></li>
      <li><a href="#cross-validation">7. Cross validation</a></li>
      <li><a href="#basic-performance-measures">8. Basic performance measures</a></li>
      <li><a href="#partial-aucs">9. Partial AUCs</a></li>
      <li><a href="#fast-auc-roc-calculation">10. Fast AUC (ROC) calculation</a></li>
      <li><a href="#balanced-and-imbalanced-datasets">11. Balanced and imbalanced datasets</a></li>
      <li><a href="#citation">12. Citation</a></li>
      <li><a href="#external-links">13. External links</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Takaya Saito, Marc Rehmsmeier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
